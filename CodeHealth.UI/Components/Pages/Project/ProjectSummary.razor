@page "/project/{ProjectId}"
@inherits ProjectSummaryPage

@using CodeHealth.UI.Components.Controls

<h3>Summary for Project: @ProjectId</h3>

@if (!isAllDataLoaded)
{
    <p>Loading...</p>
}
else
{
    <div class="mb-3">
        <strong>Last Scanned:</strong> @lastScannedTime
    </div>

    <div style="background: #fee; color: red;">@scanResultsMessage</div>

    <!-- Language Distribution Bar -->
    <LanguageDistributionBar LanguageBreakdown="@languageBreakdown" />

    <table class="table table-striped table-hover">
        <thead class="thead-dark">
            <tr>
                <th>Analyzer</th>
                <th>Details</th>
                <th>Report</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Cyclomatic Complexity</td>
                <td>
                    <span class="badge @(averageComplexity > 20 ? "bg-danger" : averageComplexity > 10 ? "bg-warning" : "bg-success")">
                        @(averageComplexity > 20 ? "High" : averageComplexity > 10 ? "Moderate" : "Low")
                    </span>
                    Total @totalComplexity, Average @($"{averageComplexity:F2}")
                </td>
                <td><a href="@($"/project/{ProjectId}/cyclomatic-complexity")">View Report</a></td>
            </tr>
            <tr>
                <td>TODOs</td>
                <td>
                    <span class="badge @(totalTodos > 20 ? "bg-danger" : totalTodos > 5 ? "bg-warning" : "bg-success")">
                        @(totalTodos > 20 ? "Many" : totalTodos > 5 ? "Some" : "Few")
                    </span>
                    @totalTodos TODO items
                </td>
                <td><a href="@($"/project/{ProjectId}/todos")">View Report</a></td>
            </tr>
        </tbody>
    </table>
}

<button class="btn btn-primary mt-3" @onclick="ScanProject">Scan Now</button>
